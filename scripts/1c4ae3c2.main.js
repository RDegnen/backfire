"use strict";function init(){var a=new TodoCollection;new AppView({collection:a})}function showBtn(){var a=$("ul").find("li").hasClass("done");a?$("#remove").show("slow"):$("#remove").hide("slow")}function checkAll(){$("li").addClass("done"),showBtn()}$(document).ready(function(){init(),$("#remove").hide(),$("ul").on("click",function(){showBtn()}),$("#remove").on("click",function(){$("#remove").hide()}),$("#check-all").on("click",function(){checkAll()})});var Todo=Backbone.Model.extend({defaults:{title:"New Todo",done:!1},toggle:function(){this.save({done:!this.get("done")}),$(".done").find("input").attr("checked","checked")}}),TodoCollection=Backbone.Firebase.Collection.extend({model:Todo,url:"https://backfiretodo.firebaseIO.com",done:function(){return this.where({done:!0})}}),TodoView=Backbone.View.extend({tagName:"li",template:_.template("<input class='toggle' type='checkbox'> <label><%= title %></label>\n<hr>"),events:{"click .toggle":"toggleDone"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el.toggleClass("done",this.model.get("done")),this},toggleDone:function(){this.model.toggle()}}),AppView=Backbone.View.extend({el:$("#backfire"),events:{"keypress #new-todo":"createTodo","click #remove":"clearDone","click #check-all":"toggleAllDone"},initialize:function(){this.list=this.$("#todo-list"),this.input=this.$("#new-todo"),this.listenTo(this.collection,"add",this.addOne)},addOne:function(a){var b=new TodoView({model:a});this.list.append(b.render().el)},createTodo:function(a){this.input.val()&&13===a.keyCode&&(this.collection.create({title:this.input.val()}),this.input.val(""))},toggleAllDone:function(){var a=$("ul").find("li").hasClass("done");this.collection.each(function(b){b.save({done:a}),$(".done").find("input").attr("checked","checked")})},clearDone:function(){return _.invoke(this.collection.done(),"destroy"),!1}});